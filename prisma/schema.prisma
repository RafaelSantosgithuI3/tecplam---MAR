generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  matricula String  @id
  name      String?
  role      String?
  shift     String?
  email     String?
  password  String?
  isAdmin   Boolean @default(false) @map("is_admin")

  @@map("users")
}

model Log {
  id            Int     @id @default(autoincrement())
  userId        String? @map("user_id")
  userName      String? @map("user_name")
  userRole      String? @map("user_role")
  line          String?
  date          String?
  itemsCount    Int?    @map("items_count")
  ngCount       Int?    @map("ng_count")
  observation   String?
  data          String?
  itemsSnapshot String? @map("items_snapshot")

  @@map("logs_lider")
}

model MaintenanceLog {
  id                Int     @id @default(autoincrement())
  userId            String? @map("user_id")
  userName          String? @map("user_name")
  userRole          String? @map("user_role")
  line              String?
  date              String?
  itemsCount        Int?    @map("items_count")
  ngCount           Int?    @map("ng_count")
  observation       String?
  data              String?
  maintenanceTarget String? @map("maintenance_target")
  itemsSnapshot     String? @map("items_snapshot")

  @@map("logs_manutencao")
}

model ChecklistItem {
  id       Int     @id @default(autoincrement())
  category String?
  text     String?
  evidence String?
  imageUrl String? @map("image_url")

  @@map("items_lider")
}

model MaintenanceChecklistItem {
  id       Int     @id @default(autoincrement())
  category String?
  text     String?
  evidence String?
  imageUrl String? @map("image_url")

  @@map("items_manutencao")
}

model LineStop {
  id           String  @id @default(uuid())
  userId       String? @map("user_id")
  userName     String? @map("user_name")
  userRole     String? @map("user_role")
  line         String?
  date         String?
  status       String?
  data         String?
  signedDocUrl String? @map("signed_doc_url")

  @@map("line_stops")
}

model Meeting {
  id           String  @id
  title        String?
  date         String?
  startTime    String? @map("start_time")
  endTime      String? @map("end_time")
  photoUrl     String? @map("photo_url")
  participants String?
  topics       String?
  createdBy    String? @map("created_by")

  @@map("meetings")
}

model ScrapLog {
  id             Int     @id @default(autoincrement())
  userId         String? @map("user_id")
  date           String?
  time           String?
  week           Int?
  shift          String?
  leaderName     String? @map("leader_name")
  pqc            String?
  model          String?
  qty            Int?
  item           String?
  status         String?
  code           String?
  description    String?
  unitValue      Float?  @map("unit_value")
  totalValue     Float?  @map("total_value")
  usedModel      String? @map("used_model")
  responsible    String?
  station        String?
  reason         String?
  rootCause      String? @map("root_cause")
  countermeasure String?
  line           String?

  nfNumber       String? @map("nf_number")
  sentBy         String? @map("sent_by")
  sentAt         DateTime? @map("sent_at")
  plant          String?
  situation      String  @default("PENDING")

  @@map("scrap_data")
  
  @@index([date])
  @@index([situation])
  @@index([nfNumber])
}

model Material {
  code        String  @id
  model       String?
  description String?
  item        String?
  plant       String?
  price       Float?

  @@map("materials")
}

model RecoveryRequest {
  id        Int      @id @default(autoincrement())
  matricula String
  name      String
  role      String
  status    String   @default("PENDING") // PENDING, COMPLETED
  createdAt DateTime @default(now())

  @@map("recovery_requests")
}

model ConfigLine {
  name String @id

  @@map("config_lines")
}

model ConfigRole {
  name String @id

  @@map("config_roles")
}

model ConfigModel {
  name String @id
  sku  String?

  @@map("config_models")
}

model ConfigStation {
  name String @id

  @@map("config_stations")
}

model ConfigPermission {
  role    String
  module  String
  allowed Int?

  @@id([role, module])
  @@map("config_permissions")
}

model PreparationLog {
  id          Int      @id @default(autoincrement())
  date        String
  shift       String
  line        String
  model       String
  sku         String?
  plate       Int?
  rear        Int?
  btFt        Int?     @map("bt_ft")
  pba         Int?
  currentRfCal Float?  @map("current_rf_cal")
  input       Int?
  preKey      Int?     @map("pre_key")
  lcia        Int?
  audio       Int?
  radiation   Int?
  imei        Int?
  vct         Int?
  revision    Int?
  desmonte    Int?
  oven        Int?
  repair      Int?
  observation String?
  responsible String?
  createdAt   DateTime @default(now()) @map("created_at")

  @@map("preparation_logs")
  @@index([date])
  @@index([shift])
  @@index([model])
}
