generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  matricula String  @id
  name      String?
  role      String?
  shift     String?
  email     String?
  password  String?
  isAdmin   Boolean @default(false) @map("is_admin")

  @@map("users")
}

model Log {
  id            Int     @id @default(autoincrement())
  userId        String? @map("user_id")
  userName      String? @map("user_name")
  userRole      String? @map("user_role")
  line          String?
  date          String?
  itemsCount    Int?    @map("items_count")
  ngCount       Int?    @map("ng_count")
  observation   String?
  data          String?
  itemsSnapshot String? @map("items_snapshot")

  @@map("logs_lider")
}

model MaintenanceLog {
  id                Int     @id @default(autoincrement())
  userId            String? @map("user_id")
  userName          String? @map("user_name")
  userRole          String? @map("user_role")
  line              String?
  date              String?
  itemsCount        Int?    @map("items_count")
  ngCount           Int?    @map("ng_count")
  observation       String?
  data              String?
  maintenanceTarget String? @map("maintenance_target")
  itemsSnapshot     String? @map("items_snapshot")

  @@map("logs_manutencao")
}

model ChecklistItem {
  id       Int     @id @default(autoincrement())
  category String?
  text     String?
  evidence String?
  imageUrl String? @map("image_url")

  @@map("items_lider")
}

model MaintenanceChecklistItem {
  id       Int     @id @default(autoincrement())
  category String?
  text     String?
  evidence String?
  imageUrl String? @map("image_url")

  @@map("items_manutencao")
}

model LineStop {
  id           String  @id @default(uuid())
  userId       String? @map("user_id")
  userName     String? @map("user_name")
  userRole     String? @map("user_role")
  line         String?
  date         String?
  status       String?
  data         String?
  signedDocUrl String? @map("signed_doc_url")
  shift        String?

  @@map("line_stops")
}

model Meeting {
  id           String  @id
  title        String?
  date         String?
  startTime    String? @map("start_time")
  endTime      String? @map("end_time")
  photoUrl     String? @map("photo_url")
  participants String?
  topics       String?
  createdBy    String? @map("created_by")

  @@map("meetings")
}

model ScrapLog {
  id             Int       @id @default(autoincrement())
  userId         String?   @map("user_id")
  date           String?
  time           String?
  week           Int?
  shift          String?
  leaderName     String?   @map("leader_name")
  pqc            String?
  model          String?
  qty            Int?
  item           String?
  status         String?
  code           String?
  description    String?
  unitValue      Float?    @map("unit_value")
  totalValue     Float?    @map("total_value")
  usedModel      String?   @map("used_model")
  responsible    String?
  station        String?
  reason         String?
  rootCause      String?   @map("root_cause")
  countermeasure String?
  immediateAction String?   @map("immediate_action")
  line           String?
  nfNumber       String?   @map("nf_number")
  sentBy         String?   @map("sent_by")
  sentAt         DateTime? @map("sent_at")
  plant          String?
  situation      String    @default("PENDING")
  qrCode         String?   @map("qr_code")
  boxId          Int?      @map("box_id")
  box            ScrapBox? @relation(fields: [boxId], references: [id])

  @@index([date])
  @@index([situation])
  @@index([nfNumber])
  @@map("scrap_data")
}

model Material {
  code        String  @id
  model       String?
  description String?
  item        String?
  plant       String?
  price       Float?

  @@map("materials")
}

model RecoveryRequest {
  id        Int      @id @default(autoincrement())
  matricula String
  name      String
  role      String
  status    String   @default("PENDING")
  createdAt DateTime @default(now())

  @@map("recovery_requests")
}

model ConfigLine {
  name String @id

  @@map("config_lines")
}

model ConfigRole {
  name String @id

  @@map("config_roles")
}

model ConfigModel {
  name String  @id
  sku  String?

  @@map("config_models")
}

model ConfigStation {
  name String @id

  @@map("config_stations")
}

model ConfigPermission {
  role    String
  module  String
  allowed Int?

  @@id([role, module])
  @@map("config_permissions")
}

model PreparationLog {
  id           Int      @id @default(autoincrement())
  date         String
  shift        String
  line         String
  model        String
  sku          String?
  plate        Int?
  rear         Int?
  btFt         Int?     @map("bt_ft")
  pba          Int?
  currentRfCal Float?   @map("current_rf_cal")
  input        Int?
  preKey       Int?     @map("pre_key")
  lcia         Int?
  audio        Int?
  radiation    Int?
  imei         Int?
  vct          Int?
  revision     Int?
  desmonte     Int?
  oven         Int?
  repair       Int?
  observation  String?
  responsible  String?
  createdAt    DateTime @default(now()) @map("created_at")

  @@index([date])
  @@index([shift])
  @@index([model])
  @@map("preparation_logs")
}

model ScrapBox {
  id        Int        @id @default(autoincrement())
  type      String
  status    String     @default("OPEN")
  nfNumber  String?    @map("nf_number")
  createdAt DateTime   @default(now()) @map("created_at")
  closedAt  DateTime?  @map("closed_at")

  scraps    ScrapLog[]

  @@map("scrap_boxes")
}

model Employee {
  matricula        String     @id @unique
  photo            String?
  fullName         String
  shift            String
  role             String
  sector           String
  superiorId       String?
  idlSt            String?
  type             String?
  status           String?
  address          String?
  addressNum       String?
  whatsapp         String?
  previousLeaders  String?

  m1               String?
  pm1              String?
  nm1              String?
  m2               String?
  pm2              String?
  nm2              String?
  m3               String?
  pm3              String?
  nm3              String?
  m4               String?
  pm4              String?
  nm4              String?
  m5               String?
  pm5              String?
  nm5              String?
  m6               String?
  pm6              String?
  nm6              String?

  attendanceLogs   AttendanceLog[]

  @@map("employees")
}

model ProductionModel {
  id             Int       @id @default(autoincrement())
  name           String

  workstations   Workstation[]

  @@map("production_models")
}

model Workstation {
  id                Int       @id @default(autoincrement())
  name              String
  modelName         String?
  order             String?
  peopleNeeded      Int
  productionModelId Int?      @map("production_model_id")

  productionModel   ProductionModel? @relation(fields: [productionModelId], references: [id])

  @@map("workstations")
}

model AttendanceLog {
  id             Int          @id @default(autoincrement())
  employeeId     String
  date           DateTime
  type           String
  delayMinutes   Int?
  loggedById     String

  employee       Employee     @relation(fields: [employeeId], references: [matricula])

  @@map("attendance_logs")
}
